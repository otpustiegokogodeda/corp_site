{% extends "base.html" %}
{% block content %}
<div class="max-w-6xl mx-auto p-4">
  <h1 class="text-2xl font-bold mb-6">üë§ –ü–∞–Ω–µ–ª—å –∫–ª–∏–µ–Ω—Ç–∞</h1>

  <section class="mb-10">
    <h2 class="text-xl font-semibold mb-3">üõí –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
    <table class="min-w-full bg-white dark:bg-gray-800 rounded shadow">
      <thead>
        <tr class="bg-gray-100 dark:bg-gray-700 text-left">
          <th class="p-3">–£—Å–ª—É–≥–∞</th>
          <th class="p-3">–°—Ç–∞—Ç—É—Å</th>
          <th class="p-3">–°—É–º–º–∞</th>
          <th class="p-3">–î–∞—Ç–∞</th>
          <th class="p-3">–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
        <tr class="border-b border-gray-200 dark:border-gray-700">
          <td class="p-3">{{ order.service.title }}</td>
          <td class="p-3">
            <span class="inline-block px-2 py-1 rounded text-white 
              {% if order.status == 'paid' %} bg-green-500 
              {% elif order.status == 'processing' %} bg-yellow-500 
              {% elif order.status == 'completed' %} bg-blue-500 
              {% elif order.status == 'canceled' %} bg-red-500 
              {% else %} bg-gray-500 {% endif %}">
              {{ order.get_status_display }}
            </span>
          </td>
          <td class="p-3">{{ order.amount }} ‚ÇΩ</td>
          <td class="p-3">{{ order.created_at|date:"d.m.Y" }}</td>
          <td class="p-3">
            <form method="post" action="{% url 'orders:repeat_order' order.id %}">
              {% csrf_token %}
              <button type="submit" class="text-sm text-blue-600 hover:underline">
                üîÅ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å
              </button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="p-4 text-center text-gray-500">–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <section>
    <h2 class="text-xl font-semibold mb-3">üìÑ –°—á–µ—Ç–∞</h2>
    <table class="min-w-full bg-white dark:bg-gray-800 rounded shadow">
      <thead>
        <tr class="bg-gray-100 dark:bg-gray-700 text-left">
          <th class="p-3">–ó–∞–∫–∞–∑</th>
          <th class="p-3">–°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã</th>
          <th class="p-3">–î–∞—Ç–∞ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è</th>
          <th class="p-3">–°–∫–∞—á–∞—Ç—å</th>
        </tr>
      </thead>
      <tbody>
        {% for invoice in invoices %}
        <tr class="border-b border-gray-200 dark:border-gray-700">
          <td class="p-3">#{{ invoice.order.id }} ‚Äî {{ invoice.order.service.title }}</td>
          <td class="p-3">
            {% if invoice.is_paid %}
              <span class="text-green-600 font-semibold">–û–ø–ª–∞—á–µ–Ω</span>
            {% else %}
              <span class="text-red-600 font-semibold">–ù–µ –æ–ø–ª–∞—á–µ–Ω</span>
            {% endif %}
          </td>
          <td class="p-3">{{ invoice.issued_at|date:"d.m.Y" }}</td>
          <td class="p-3">
            <a href="{{ invoice.pdf_file.url }}" class="text-blue-600 hover:underline" target="_blank">
              üì• –°–∫–∞—á–∞—Ç—å PDF
            </a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="p-4 text-center text-gray-500">–°—á–µ—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</div>
{% endblock %}